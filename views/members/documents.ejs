<% title = 'Documents' %>

<div class="px-4 sm:px-0">
  <!-- Page Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold tracking-tight text-gray-900">Documents</h1>
    <p class="mt-2 text-sm text-gray-700">Access training materials, forms, and other resources.</p>
  </div>

  <% if (documents.length === 0) { %>
    <div class="text-center py-12 card">
      <div class="card-body">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        <h3 class="mt-2 text-sm font-medium text-gray-900">No documents available</h3>
        <p class="mt-1 text-sm text-gray-500">Check back later or achieve higher tiers to access more documents.</p>
      </div>
    </div>
  <% } else { %>
    <!-- List View -->
    <div class="card">
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-300">
          <thead>
            <tr class="bg-gray-50">
              <th class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900">Document</th>
              <th class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 hidden md:table-cell">Description</th>
              <th class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 hidden lg:table-cell">Tier</th>
              <th class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 hidden sm:table-cell">Size</th>
              <th class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 hidden lg:table-cell">Uploaded</th>
              <th class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                <span class="sr-only">Download</span>
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 bg-white">
            <% documents.forEach(doc => { %>
              <tr class="hover:bg-gray-50">
                <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm">
                  <div class="flex items-center">
                    <div class="h-10 w-10 flex-shrink-0 flex items-center justify-center rounded-lg bg-indigo-100">
                      <% 
                        let icon = 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z';
                        if (doc.mime_type && doc.mime_type.includes('pdf')) {
                          icon = 'M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z';
                        } else if (doc.mime_type && (doc.mime_type.includes('excel') || doc.mime_type.includes('spreadsheet'))) {
                          icon = 'M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z';
                        } else if (doc.mime_type && (doc.mime_type.includes('image') || doc.mime_type.includes('png') || doc.mime_type.includes('jpg') || doc.mime_type.includes('jpeg'))) {
                          icon = 'M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z';
                        }
                      %>
                      <svg class="h-6 w-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="<%= icon %>"></path>
                      </svg>
                    </div>
                    <div class="ml-4">
                      <div class="font-medium text-gray-900"><%= doc.title %></div>
                      <div class="text-xs text-gray-500 md:hidden">
                        <%= (doc.file_size / 1024 / 1024).toFixed(2) %> MB
                        <% if (doc.tier_name) { %>
                          Â· <%= doc.tier_name %>
                        <% } %>
                      </div>
                    </div>
                  </div>
                </td>
                <td class="px-3 py-4 text-sm text-gray-500 hidden md:table-cell max-w-xs truncate">
                  <%= doc.description || '-' %>
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm hidden lg:table-cell">
                  <% if (doc.tier_name) { %>
                    <span class="badge badge-info"><%= doc.tier_name %></span>
                  <% } else { %>
                    <span class="text-gray-400">All members</span>
                  <% } %>
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 hidden sm:table-cell">
                  <%= (doc.file_size / 1024 / 1024).toFixed(2) %> MB
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 hidden lg:table-cell">
                  <div><%= new Date(doc.created_at).toLocaleDateString() %></div>
                  <% if (doc.uploaded_by_callsign) { %>
                    <div class="text-xs text-gray-400"><%= doc.uploaded_by_callsign %></div>
                  <% } %>
                </td>
                <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                  <a 
                    href="/members/documents/<%= doc.id %>/download" 
                    class="text-indigo-600 hover:text-indigo-900 inline-flex items-center"
                  >
                    <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                    <span class="ml-1 hidden sm:inline">Download</span>
                  </a>
                </td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    </div>
  <% } %>
</div>

